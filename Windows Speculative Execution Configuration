# Apply Speculative Execution Mitigations
$memMgmtPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
$overrideKeys = @{
    "FeatureSettingsOverride" = 3
    "FeatureSettingsOverrideMask" = 3
}

foreach ($name in $overrideKeys.Keys) {
    Set-ItemProperty -Path $memMgmtPath -Name $name -Value $overrideKeys[$name] -Force
}

# Restart to apply changes
Restart-Computer -Force
