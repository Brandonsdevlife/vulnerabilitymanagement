Deploying PowerShell Scripts via Group Policy (GPO)

Step 1: Preparing the Environment
Ensure that your Group Policy infrastructure is correctly configured.
Make sure the target machines are within the OU where the GPO will be applied.

Step 2: Creating the GPO
Create a New GPO:
Open the Group Policy Management Console (GPMC).
Right-click on your domain or the specific Organizational Unit (OU) where the GPO will be linked, and select Create a GPO in this domain, and link it here.
Name the GPO (e.g., "Deploy PowerShell Scripts").

Step 3: Configuring the GPO for Startup Scripts
Edit the GPO:

Right-click the GPO and select Edit.
Navigate to Computer Configuration > Policies > Windows Settings > Scripts (Startup/Shutdown).
Add the PowerShell Script:

Double-click Startup in the right pane, then click Add.
In the Script Name field, browse to the location where your PowerShell script is stored (preferably a network share accessible by all target machines).
Add any required parameters in the Script Parameters field.
Click OK to confirm the script addition.

Step 4: Linking and Applying the GPO
Link the GPO:

If the GPO is not already linked to the desired OU, right-click the OU and choose Link an Existing GPO.
Select the newly created GPO.
Force a Group Policy Update:

Run the following command on target machines or remotely to force the GPO to apply immediately:
powershell
Copy code
gpupdate /force

Step 5: Monitoring and Troubleshooting
Use Event Viewer on client machines to verify the execution of startup scripts under Application and Services Logs > Microsoft > Windows > Group Policy > Operational.
Logs for script execution can also be found in C:\Windows\System32\GroupPolicy\Machine\Scripts\Startup.
Best Practices
Startup vs. Logon Scripts: For scripts that require administrative privileges or need to run before user logon, configure them as Startup scripts rather than Logon scripts.
Network Accessibility: Ensure that the script location is accessible by all target machines, especially if using a network share.
